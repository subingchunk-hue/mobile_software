<!--memory-detail.wxml-->
<view class="page">

  
  <!-- 编辑模式标题 -->
  <view class="edit-header" wx:if="{{isEditing}}">
    <input class="edit-title-input" placeholder="请输入标题" value="{{editTitle}}" bindinput="onTitleInput" />
  </view>
  
  <view class="detail-container">
    
    <!-- 回忆详情内容 -->
    <view class="detail-content">
        <!-- 学期时间 -->
        <view class="detail-item">
            <text class="detail-label">学期</text>
            <text class="detail-value semester">{{memoryDetail.semester}}</text>
        </view>
    
        <!-- 非编辑模式 -->
        <view wx:if="{{!isEditing}}">
            <!-- 事件概括 -->
            <view class="detail-item">
                <text class="detail-label">事件概括</text>
                <text class="detail-value summary">{{memoryDetail.summary}}</text>
            </view>
        
            <!-- 详细描述 -->
            <view class="detail-item">
                <text class="detail-label">详细描述</text>
                <text class="detail-value description">{{memoryDetail.description}}</text>
            </view>
        
            <!-- 心情记录 -->
            <view class="detail-item">
                <text class="detail-label">心情记录</text>
                <text class="detail-value mood">{{memoryDetail.mood}}</text>
            </view>
        </view>
        
        <!-- 编辑模式 -->
        <view wx:if="{{isEditing}}">
            <!-- 事件概括编辑 -->
            <view class="detail-item">
                <text class="detail-label">事件概括</text>
                <input class="edit-input" placeholder="请输入事件概括" value="{{editSummary}}" bindinput="onSummaryInput" />
            </view>
        
            <!-- 详细描述编辑 -->
            <view class="detail-item">
                <text class="detail-label">详细描述</text>
                <textarea class="edit-textarea" placeholder="请输入详细描述" value="{{editDescription}}" bindinput="onDescriptionInput" maxlength="500"></textarea>
            </view>
        
            <!-- 心情记录编辑 -->
            <view class="detail-item">
                <text class="detail-label">心情记录</text>
                <input class="edit-input" placeholder="请输入心情记录" value="{{editMood}}" bindinput="onMoodInput" />
            </view>
        </view>
    
        <!-- 大概时间 -->
        <view class="detail-item" wx:if="{{memoryDetail.time}}">
            <text class="detail-label">大概时间</text>
            <text class="detail-value time">{{memoryDetail.time}}</text>
        </view>
    
        <!-- 照片区域 -->
        <view class="detail-item" wx:if="{{!isEditing && memoryDetail.images && memoryDetail.images.length > 0}}">
            <text class="detail-label">照片</text>
            <view class="image-gallery" data-count="{{memoryDetail.images.length}}">
                <image class="memory-image" wx:for="{{memoryDetail.images}}" wx:key="index" src="{{item}}" mode="aspectFill"></image>
            </view>
        </view>
        
        <!-- 编辑模式照片区域 -->
        <view class="detail-item" wx:if="{{isEditing}}">
            <text class="detail-label">照片</text>
            <view class="edit-image-gallery">
                <view class="edit-image-item" wx:for="{{editImages}}" wx:key="index">
                    <image class="edit-image" src="{{item}}" mode="aspectFill"></image>
                    <view class="delete-image-btn" bindtap="deletePhoto" data-index="{{index}}">×</view>
                </view>
                <view class="add-image-btn" bindtap="addPhoto" wx:if="{{editImages.length < 9}}">
                    <text class="add-icon">+</text>
                </view>
            </view>
        </view>
    

        <!-- 非编辑模式按钮 -->
        <view wx:if="{{!isEditing}}">
            <!-- 修改按钮 -->
            <button class="edit-btn" bindtap="editMemory">修改回忆</button>
            
            <!-- 删除按钮 -->
            <button class="delete-btn" bindtap="deleteMemory">删除回忆</button>
        </view>
        
        <!-- 编辑模式按钮 -->
        <view wx:if="{{isEditing}}">
            <!-- 保存按钮 -->
            <button class="save-btn" bindtap="saveEdit">保存修改</button>
            
            <!-- 取消按钮 -->
            <button class="cancel-btn" bindtap="cancelEdit">取消</button>
        </view>
    </view>
  </view>
</view>